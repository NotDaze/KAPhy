var KAPhy={loaded:!0,loopedFunction:null,loopedFunctionInterval:null,loopedFunctionFrameRate:60,Canvas:{configured:!1,relWidth:null,relHeight:null,element:null,context:null},Draw:{currentRectMode:"CORNER",currentImageMode:"CORNER",currentEllipseMode:"CENTER",currentTextLineSpacing:.4,shapeOpen:!1},Physics:{airResistance:.99,airResistanceSleeping:.9,gravityForce:.7,constraintAdjustment:.3,circleAdjustment:.3},Interface:{selected:null}},CENTER="CENTER",CORNER="CORNER",RADIUS="RADIUS",CORNERS="CORNERS",MITER="miter",ROUND="round",BEVEL="bevel",SQUARE="butt",PROJECT="square",START="start",END="end",LEFT="left",RIGHT="right",CENTER="center",TOP="top",BOTTOM="bottom",MIDDLE="middle",ALPHABETIC="alphabetic",HANGING="hanging";if(KAPhy.Canvas.Animation||(KAPhy.Canvas.Animation=function(a,e){a.transition&&(KAPhy.Canvas.Animation.transitions[a.transition]||(console.warn("KAPhy Warning - Invalid animation transition specified. Defaulted to linear."),a.transition="linear")),this.duration=a.duration||1e3,this.startTime=(new Date).getTime(),this.startValue=a.start||0,this.finalValue=0===a.final?0:0===a.end?0:a.end||a.final||1,this.transition=a.transition||"linear",this.looped=e||!1},KAPhy.Canvas.Animation.transitions={linear:function(a){return a},easeInSine:function(a){return 1-Math.sin((a+1)*Math.PI/2)},easeOutSine:function(a){return Math.sin(a*Math.PI/2)},easeInOutSine:function(a){return Math.sin((a-.5)*Math.PI)/2+.5},easeInQuad:function(a){return a*a},easeOutQuad:function(a){return a*(2-a)},easeInOutQuad:function(a){return a<.5?2*a*a:-2*--a*a+1},easeInCubic:function(a){return a*a*a},easeOutCubic:function(a){return--a*a*a+1},easeInOutCubic:function(a){return a<.5?4*a*a*a:4*--a*a*a+1},easeInQuart:function(a){return a*a*a*a},easeOutQuart:function(a){return- --a*a*a*a+1},easeInOutQuart:function(a){return a<.5?8*a*a*a*a:8*(a-1)*(a-1)*(a-1)*(a-1)+1},easeInQuint:function(a){return a*a*a*a*a},easeOutQuint:function(a){return--a*a*a*a*a+1},easeInOutQuint:function(a){return a<.5?16*a*a*a*a*a:16*--a*a*a*a*a+1}}),KAPhy.Canvas.AnimationSet||(KAPhy.Canvas.AnimationSet=function(a,e){this.animInfo=a.slice(),this.looped=e||!1,this.looped&&(this.animInfoBackup=this.animInfo.slice()),this.currentAnimation=new KAPhy.Canvas.Animation(this.animInfo.shift())}),KAPhy.Canvas.AnimationSet.prototype.getValue||(KAPhy.Canvas.AnimationSet.prototype.getValue=function(){for(;this.currentAnimation.isExpired();)0!==this.animInfo.length?this.currentAnimation=new KAPhy.Canvas.Animation(this.animInfo.shift()):this.looped&&(this.animInfo=this.animInfoBackup.slice(),this.currentAnimation=new KAPhy.Canvas.Animation(this.animInfo.shift()));return this.currentAnimation.getValue()}),KAPhy.Canvas.AnimationSet.prototype.isExpired||(KAPhy.Canvas.AnimationSet.prototype.isExpired=function(){return 0===this.animInfo.length&&!this.looped&&this.currentAnimation.isExpired()}),KAPhy.Canvas.Animation.getValue||(KAPhy.Canvas.Animation.getValue=function(a){var e,s=(new Date).getTime(),n=a.startTime,t=a.duration;a.startValue,a.finalValue;if(a.looped)e=KAPhy.Canvas.Animation.transitions[a.transition]((s-n)/t%1);else{if((e=KAPhy.Canvas.Animation.transitions[a.transition]((s-n)/t))<0)return startValue;if(e>1)return finalValue}return startValue+(finalValue-startValue)*e}),KAPhy.Canvas.Animation.prototype.getValue||(KAPhy.Canvas.Animation.prototype.getValue=function(){return KAPhy.Canvas.Animation.getValue(this)}),KAPhy.Canvas.Animation.prototype.isExpired||(KAPhy.Canvas.Animation.prototype.isExpired=function(){return(new Date).getTime()-this.startTime>=this.duration}),KAPhy.ImportKA||(KAPhy.ImportKA=function(a,e){var s=document.createElement("script");s.setAttribute("src","https://www.khanacademy.org/api/labs/scratchpads/"+a+"?callback=read&_="+Date.now()),document.body.appendChild(s)}),KAPhy.loop||(KAPhy.loop=function(a){a&&(KAPhy.loopedFunctionInterval&&clearInterval(KAPhy.loopedFunctionInterval),KAPhy.loopedFunction=a,KAPhy.loopedFunctionInterval=setInterval(function(){KAPhy.loopedFunction(),KAPhy.Canvas.update()},1e3/KAPhy.loopedFunctionFrameRate))}),KAPhy.noLoop||(KAPhy.noLoop=function(){KAPhy.loopedFunction&&(clearInterval(KAPhy.loopedFunctionInterval),KAPhy.loopedFunction=null)}),KAPhy.frameRate||(KAPhy.frameRate=function(a){KAPhy.loopedFunctionFrameRate=a||60,KAPhy.loopedFunction&&(clearInterval(KAPhy.loopedFunctionInterval),KAPhy.loopedFunctionInterval=setInterval(function(){KAPhy.loopedFunction(),KAPhy.Canvas.update()},1e3/KAPhy.loopedFunctionFrameRate))}),KAPhy.Interface.Basic||(KAPhy.Interface.Basic=function(a){this.pos=a.pos||new KAPhy.Physics.Vector2(a.x||0,a.y||0),this.width=a.width||a.w||a.size||100,this.height=a.height||a.h||a.size||100},KAPhy.Interface.Basic.prototype.down=function(){return this.mouseOver()&&KAPhy.Canvas.mouseIsPressed},KAPhy.Interface.Basic.prototype.pressed=function(){return this.mouseOver()&&KAPhy.Canvas.mouseIsPressed&&!KAPhy.Canvas.pmouseIsPressed},KAPhy.Interface.Basic.prototype.released=function(){return this.mouseOver()&&KAPhy.Canvas.pmouseIsPressed&&!KAPhy.Canvas.mouseIsPressed},KAPhy.Interface.Basic.prototype.select=function(){this.down()&&!KAPhy.Interface.selected&&(KAPhy.Interface.selected=this)},KAPhy.Interface.Basic.prototype.display=function(){this.select(),this.update&&this.update(),this.drag&&this.drag()}),KAPhy.Interface.EllipseBasic||(KAPhy.Interface.EllipseBasic=function(a){KAPhy.Interface.Basic.call(this,a)},KAPhy.Interface.EllipseBasic.prototype=Object.create(KAPhy.Interface.Basic.prototype),KAPhy.Interface.EllipseBasic.prototype.mouseOver=function(){return Math.sqrt((KAPhy.Canvas.mouseX-this.pos.x)*(KAPhy.Canvas.mouseX-this.pos.x)*this.height/this.width*this.height/this.width+(KAPhy.Canvas.mouseY-this.pos.y)*(KAPhy.Canvas.mouseY-this.pos.y))<this.height/2},KAPhy.Interface.EllipseBasic.prototype.pmouseOver=function(){return Math.sqrt((KAPhy.Canvas.pmouseX-this.pos.x)*(KAPhy.Canvas.pmouseX-this.pos.x)*this.height/this.width*this.height/this.width+(KAPhy.Canvas.pmouseY-this.pos.y)*(KAPhy.Canvas.pmouseY-this.pos.y))<this.height/2},KAPhy.Interface.EllipseBasic.prototype.draw=function(){KAPhy.Draw.ellipse(this.pos.x,this.pos.y,this.width,this.height)}),KAPhy.Interface.EllipseButton||(KAPhy.Interface.EllipseButton=function(a){KAPhy.Interface.EllipseBasic.call(this,a),this.onHold=a.onHold||function(){},this.onHover=a.onHover||function(){},this.onPress=a.onPress||function(){},this.onRelease=a.onRelease||function(){}},KAPhy.Interface.EllipseButton.prototype=Object.create(KAPhy.Interface.EllipseBasic.prototype),KAPhy.Interface.EllipseButton.prototype.update=function(){this.mouseOver()&&this.onHover(),this.down()&&this.onHold(),this.pressed()&&this.onPress(),this.released()&&this.onRelease()}),KAPhy.Interface.EllipseDragger||(KAPhy.Interface.EllipseDragger=function(a){KAPhy.Interface.EllipseButton.call(this,a),this.onMove=a.onMove||function(){}},KAPhy.Interface.EllipseDragger.prototype=Object.create(KAPhy.Interface.EllipseButton.prototype),KAPhy.Interface.EllipseDragger.prototype.drag=function(){KAPhy.Interface.selected===this&&(KAPhy.Canvas.pmouseX===KAPhy.Canvas.mouseX&&KAPhy.Canvas.pmouseY===KAPhy.Canvas.mouseY||(this.pos.x+=KAPhy.Canvas.mouseX-KAPhy.Canvas.pmouseX,this.pos.y+=KAPhy.Canvas.mouseY-KAPhy.Canvas.pmouseY,this.onMove()))}),KAPhy.Interface.RectBasic||(KAPhy.Interface.RectBasic=function(a){KAPhy.Interface.Basic.call(this,a)},KAPhy.Interface.RectBasic.prototype=Object.create(KAPhy.Interface.Basic.prototype),KAPhy.Interface.RectBasic.prototype.mouseOver=function(){return KAPhy.Canvas.mouseX>=this.pos.x&&KAPhy.Canvas.mouseY>=this.pos.y&&KAPhy.Canvas.mouseX<=this.pos.x+this.width&&KAPhy.Canvas.mouseY<=this.pos.y+this.height},KAPhy.Interface.RectBasic.prototype.pmouseOver=function(){return KAPhy.Canvas.pmouseX>=this.pos.x&&KAPhy.Canvas.pmouseY>=this.pos.y&&KAPhy.Canvas.pmouseX<=this.pos.x+this.width&&KAPhy.Canvas.pmouseY<=this.pos.y+this.height},KAPhy.Interface.RectBasic.prototype.draw=function(){KAPhy.Draw.rect(this.pos.x,this.pos.y,this.width,this.height)}),KAPhy.Interface.RectButton||(KAPhy.Interface.RectButton=function(a){KAPhy.Interface.RectBasic.call(this,a),this.onHold=a.onHold||function(){},this.onHover=a.onHover||function(){},this.onPress=a.onPress||function(){},this.onRelease=a.onRelease||function(){}},KAPhy.Interface.RectButton.prototype=Object.create(KAPhy.Interface.RectBasic.prototype),KAPhy.Interface.RectButton.prototype.update=function(){this.mouseOver()&&this.onHover(),this.down()&&this.onHold(),this.pressed()&&this.onPress(),this.released()&&this.onRelease()}),KAPhy.Interface.RectDragger||(KAPhy.Interface.RectDragger=function(a){KAPhy.Interface.RectButton.call(this,a),this.onMove=a.onMove||function(){}},KAPhy.Interface.RectDragger.prototype=Object.create(KAPhy.Interface.RectButton.prototype),KAPhy.Interface.RectDragger.prototype.drag=function(){KAPhy.Interface.selected===this&&(KAPhy.Canvas.pmouseX===KAPhy.Canvas.mouseX&&KAPhy.Canvas.pmouseY===KAPhy.Canvas.mouseY||(this.pos.x+=KAPhy.Canvas.mouseX-KAPhy.Canvas.pmouseX,this.pos.y+=KAPhy.Canvas.mouseY-KAPhy.Canvas.pmouseY,this.onMove()))}),KAPhy.Interface.updateSet||(KAPhy.Interface.updateSet=function(a){for(e=a.length-1;e>=0;e--)a[e].display();for(var e=0;e<a.length;e++)if(a[e]===KAPhy.Interface.selected)return void a.push(a.splice(e,1)[0])}),KAPhy.Canvas.configure||(KAPhy.Canvas.configure=function(a){this.configured?console.warn("KAPhy Warning - Please deconfigure canvas before reconfiguring it."):(KAPhy.Canvas.element=a,KAPhy.Canvas.configured=!0,KAPhy.Canvas.relWidth=a.width,KAPhy.Canvas.relHeight=a.height,KAPhy.Canvas.context=a.getContext("2d"),KAPhy.Canvas.context.fillStyle="rgba(255, 255, 255, 1.0)",KAPhy.Canvas.pmouseX=0,KAPhy.Canvas.pmouseY=0,KAPhy.Canvas.mouseX=0,KAPhy.Canvas.mouseY=0,KAPhy.Canvas.mouseIsPressed=!1,KAPhy.Canvas.pmouseIsPressed=!1,KAPhy.Canvas.keys={},KAPhy.Canvas.keyIsPressed=!1,KAPhy.Canvas.lastKeyTriggered=null,KAPhy.Canvas.lastKeyEvent=null,KAPhy.Canvas.element.onmousemove=function(a){var e=KAPhy.Canvas.element.getBoundingClientRect();KAPhy.Canvas.mouseX=Math.round(KAPhy.Canvas.toCanvasUnits(a.clientX-e.left)),KAPhy.Canvas.mouseY=Math.round(KAPhy.Canvas.toCanvasUnits(a.clientY-e.top)),KAPhy.Canvas.mouseMoved&&KAPhy.Canvas.mouseMoved(),KAPhy.Canvas.mouseIsPressed&&KAPhy.Canvas.mouseDragged&&KAPhy.Canvas.mouseDragged()},KAPhy.Canvas.element.onmousedown=function(){KAPhy.Canvas.mouseIsPressed=!0,KAPhy.Canvas.mousePressed&&KAPhy.Canvas.mousePressed()},KAPhy.Canvas.element.onmouseup=function(){KAPhy.Canvas.mouseIsPressed=!1,KAPhy.Canvas.mouseClicked&&KAPhy.Canvas.mouseClicked(),KAPhy.Canvas.mouseReleased&&KAPhy.Canvas.mouseReleased()},KAPhy.Canvas.element.onmouseout=function(){KAPhy.Canvas.mouseOut&&KAPhy.Canvas.mouseOut()},KAPhy.Canvas.element.onmouseover=function(){KAPhy.Canvas.mouseOver&&KAPhy.Canvas.mouseOver()},window.onkeydown=function(a){KAPhy.Canvas.keys[a.key.toLowerCase()]||(KAPhy.Canvas.keys[a.key.toLowerCase()]=!0,KAPhy.Canvas.keyIsPressed=!0,KAPhy.Canvas.lastKeyDown=a.key.toLowerCase(),KAPhy.Canvas.keyPressed&&KAPhy.Canvas.keyPressed())},window.onkeyup=function(a){if(KAPhy.Canvas.keys[a.key.toLowerCase()]){KAPhy.Canvas.keys[a.key.toLowerCase()]=!1,KAPhy.Canvas.lastKeyUp=a.key.toLowerCase();(function(){for(var a in KAPhy.Canvas.keys)if(KAPhy.Canvas.keys[a])return;KAPhy.Canvas.keyIsPressed=!1})();KAPhy.Canvas.keyReleased&&KAPhy.Canvas.keyReleased(),KAPhy.Canvas.keyTyped&&KAPhy.Canvas.keyTyped()}})}),KAPhy.Canvas.toPixels||(KAPhy.Canvas.toPixels=function(a){return a*KAPhy.Canvas.element.width/KAPhy.Canvas.relWidth}),KAPhy.Canvas.toCanvasUnits||(KAPhy.Canvas.toCanvasUnits=function(a){return a*KAPhy.Canvas.relHeight/KAPhy.Canvas.element.height}),KAPhy.Canvas.deconfigure||(KAPhy.Canvas.deconfigure=function(a){this.configured?(KAPhy.Canvas.element.onmousemove=null,KAPhy.Canvas.element.onmousedown=null,KAPhy.Canvas.element.onmouseup=null,KAPhy.Canvas.element.onmouseout=null,KAPhy.Canvas.element.onmouseover=null,KAPhy.Canvas.element=null,KAPhy.Canvas.configured=!1,window.onkeydown=null,window.onkeyup=null,KAPhy.Canvas.lastKeyUp=null,KAPhy.Canvas.lastKeyDown=null,KAPhy.Canvas.keyIsPressed=null,KAPhy.Canvas.keys=null,KAPhy.Canvas.relWidth=null,KAPhy.Canvas.relHeight=null,KAPhy.Canvas.context=null,KAPhy.Canvas.mouseX=null,KAPhy.Canvas.mouseY=null,KAPhy.Canvas.mouseIsPressed=null,KAPhy.Canvas.pmouseIsPressed=null):console.warn("KAPhy warning - Attempted to reconfigure canvas.")}),KAPhy.Canvas.resize||(KAPhy.Canvas.resize=function(a,e){var s=window.innerWidth,n=window.innerHeight;s&&0!==s||(s=document.documentElement.clientWidth),n&&0!==n||(n=document.documentElement.clientHeight),KAPhy.Canvas.configured?(KAPhy.Canvas.relWidth=a,KAPhy.Canvas.relHeight=e,s/n<a/e?(KAPhy.Canvas.element.width=s,KAPhy.Canvas.element.height=e/a*s):(KAPhy.Canvas.element.width=a/e*n,KAPhy.Canvas.element.height=n)):console.warn("KAPhy warning - Attempted to resize when not configured")}),KAPhy.Canvas.update||(KAPhy.Canvas.update=function(){this.configured&&(KAPhy.Canvas.pmouseIsPressed=KAPhy.Canvas.mouseIsPressed,KAPhy.Canvas.pmouseX=KAPhy.Canvas.mouseX,KAPhy.Canvas.pmouseY=KAPhy.Canvas.mouseY,KAPhy.Canvas.mouseIsPressed||(KAPhy.Interface.selected=null))}),KAPhy.Draw.fill||(KAPhy.Draw.fill=function(){if(KAPhy.Canvas.configured)if(KAPhy.Draw.shapeOn)console.warn("KAPhy Warning - You can't use color commands when in shape mode.");else if(arguments.length>=1&&"object"==typeof arguments[0])KAPhy.Canvas.context.fillStyle="rgba("+arguments[0].r+", "+arguments[0].g+", "+arguments[0].b+", "+arguments[0].a/255+")";else switch(arguments.length){case 0:KAPhy.Canvas.context.fillStyle="#FFFFFF";break;case 1:KAPhy.Canvas.context.fillStyle="rgb("+arguments[0]+", "+arguments[0]+", "+arguments[0]+")";break;case 2:KAPhy.Canvas.context.fillStyle="rgba("+arguments[0]+", "+arguments[0]+", "+arguments[0]+", "+arguments[1]/255+")";break;case 3:KAPhy.Canvas.context.fillStyle="rgb("+arguments[0]+", "+arguments[1]+", "+arguments[2]+")";break;case 4:KAPhy.Canvas.context.fillStyle="rgba("+arguments[0]+", "+arguments[1]+", "+arguments[2]+", "+arguments[3]/255+")";break;default:console.warn("KAPhy Warning - KAPhy.Draw.fill() takes 0 - 4 arguments.")}else console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.getFill||(KAPhy.Draw.getFill=function(){if(KAPhy.Canvas.configured){var a=function(a){switch(a.toString().toLowerCase()){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case"a":return 10;case"b":return 11;case"c":return 12;case"d":return 13;case"e":return 14;case"f":return 15}},e=KAPhy.Canvas.context.fillStyle;return"#"===e[0]?{r:16*a(e[1])+a(e[2]),g:16*a(e[3])+a(e[4]),b:16*a(e[5])+a(e[6]),a:255}:(e[0]=e[0].split(""),e[0].splice(0,5),e[0]=parseFloat(e[0].join("")),e[1]=parseFloat(e[1]),e[2]=parseFloat(e[2]),e[3]=e[3].split(""),e[3].pop(),e[3]=parseFloat(e[3].join("")),{r:e[0],g:e[1],b:e[2],a:255*e[3]})}console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.getStroke||(KAPhy.Draw.getStroke=function(){if(KAPhy.Canvas.configured){var a=function(a){switch(a.toString().toLowerCase()){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case"a":return 10;case"b":return 11;case"c":return 12;case"d":return 13;case"e":return 14;case"f":return 15}},e=KAPhy.Canvas.context.strokeStyle;return"#"===e[0]?{r:16*a(e[1])+a(e[2]),g:16*a(e[3])+a(e[4]),b:16*a(e[5])+a(e[6]),a:255}:(e[0]=e[0].split(""),e[0].splice(0,5),e[0]=parseFloat(e[0].join("")),e[1]=parseFloat(e[1]),e[2]=parseFloat(e[2]),e[3]=e[3].split(""),e[3].pop(),e[3]=parseFloat(e[3].join("")),{r:e[0],g:e[1],b:e[2],a:255*e[3]})}console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.noFill||(KAPhy.Draw.noFill=function(){KAPhy.Canvas.configured?KAPhy.Canvas.context.fillStyle="rgba(0, 0, 0, 0.0)":console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.noStroke||(KAPhy.Draw.noStroke=function(){KAPhy.Canvas.configured?KAPhy.Draw.shapeOn?console.warn("KAPhy Warning - You can't use color commands when in shape mode."):(0!==arguments.length&&console.warn("KAPhy Warning - KAPhy.Draw.noStroke() takes 0 arguments."),KAPhy.Canvas.context.strokeStyle="rgba(0, 0, 0, 0.0)"):console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.stroke||(KAPhy.Draw.stroke=function(a,e,s,n){if(KAPhy.Canvas.configured)if(KAPhy.Draw.shapeOn)console.warn("KAPhy Warning - You can't use color commands when in shape mode.");else if(arguments.length>=1&&"object"==typeof arguments[0])KAPhy.Canvas.context.strokeStyle="rgba("+arguments[0].r+", "+arguments[0].g+", "+arguments[0].b+", "+arguments[0].a/255+")";else switch(arguments.length){case 0:KAPhy.Canvas.context.strokeStyle="#FFFFFF";break;case 1:KAPhy.Canvas.context.strokeStyle="rgb("+arguments[0]+", "+arguments[0]+", "+arguments[0]+")";break;case 2:KAPhy.Canvas.context.strokeStyle="rgba("+arguments[0]+", "+arguments[0]+", "+arguments[0]+", "+arguments[1]/255+")";break;case 3:KAPhy.Canvas.context.strokeStyle="rgb("+arguments[0]+", "+arguments[1]+", "+arguments[2]+")";break;case 4:KAPhy.Canvas.context.strokeStyle="rgba("+arguments[0]+", "+arguments[1]+", "+arguments[2]+", "+arguments[3]/255+")";break;default:console.warn("KAPhy Warning - KAPhy.Draw.stroke() takes 0 - 4 arguments.")}else console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.get||(KAPhy.Draw.get=function(a,e,s,n){if(KAPhy.Canvas.configured){if(4===arguments.length){var t=KAPhy.Canvas.context.getImageData(KAPhy.Canvas.toPixels(a),KAPhy.Canvas.toPixels(e),KAPhy.Canvas.toPixels(s),KAPhy.Canvas.toPixels(n)),o=document.createElement("canvas");return o.width=t.width,o.height=t.height,o.getContext("2d").putImageData(t,0,0),o}if(2===arguments.length){var r=KAPhy.Canvas.context.getImageData(KAPhy.Canvas.toPixels(a),KAPhy.Canvas.toPixels(e),1,1);return{r:r.data[0],g:r.data[1],b:r.data[2],a:255*r.data[3]}}}else console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.image||(KAPhy.Draw.image=function(a,e,s,n,t,o,r,i,h){if(KAPhy.Canvas.configured)if(KAPhy.Draw.shapeOn)console.warn("KAPhy Warning - You can't use other drawing commands when in shape mode.");else{var c=e,y=s,P=n,g=t;switch(KAPhy.Draw.currentImageMode){case CORNERS:P=n-e,g=t-s;break;case RADIUS:c=e+n/2,y=s+t/2,P=2*n,g=2*t;break;case CENTER:c=e-n/2,y=s-t/2}switch(c=KAPhy.Canvas.toPixels(c),y=KAPhy.Canvas.toPixels(y),P=KAPhy.Canvas.toPixels(P),g=KAPhy.Canvas.toPixels(g),arguments.length){case 3:KAPhy.Canvas.context.drawImage(a,c,y);break;case 5:KAPhy.Canvas.context.drawImage(a,c,y,P,g);break;case 9:KAPhy.Canvas.context.drawImage(a,c,y,P,g,o,r,i,h);break;default:console.warn("KAPhy Warning - KAPhy.Draw.image() takes 3, 5, or 9 arguments.")}}else console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),!Images)var Images={avatarTeam:"https://www.kasandbox.org/programming-images/avatars/avatar-team.png",aqualineSeed:"https://www.kasandbox.org/programming-images/avatars/aqualine-seed.png",aqualineSeedling:"https://www.kasandbox.org/programming-images/avatars/aqualine-seedling.png",aqualineSapling:"https://www.kasandbox.org/programming-images/avatars/aqualine-sapling.png",aqualineTree:"https://www.kasandbox.org/programming-images/avatars/aqualine-tree.png",aqualineUltimate:"https://www.kasandbox.org/programming-images/avatars/aqualine-ultimate.png",duskpinSeed:"https://www.kasandbox.org/programming-images/avatars/duskpin-seed.png",duskpinSeedling:"https://www.kasandbox.org/programming-images/avatars/duskpin-seedling.png",duskpinSapling:"https://www.kasandbox.org/programming-images/avatars/duskpin-sapling.png",duskpinTree:"https://www.kasandbox.org/programming-images/avatars/duskpin-tree.png",duskpinUltimate:"https://www.kasandbox.org/programming-images/avatars/duskpin-ultimate.png",leafersSeed:"https://www.kasandbox.org/programming-images/avatars/leafers-seed.png",leafersSeedling:"https://www.kasandbox.org/programming-images/avatars/leafers-seedling.png",leafersSapling:"https://www.kasandbox.org/programming-images/avatars/leafers-sapling.png",leafersTree:"https://www.kasandbox.org/programming-images/avatars/leafers-tree.png",leafersUltimate:"https://www.kasandbox.org/programming-images/avatars/leafers-ultimate.png",piceratopsSeed:"https://www.kasandbox.org/programming-images/avatars/piceratops-seed.png",piceratopsSeedling:"https://www.kasandbox.org/programming-images/avatars/piceratops-seedling.png",piceratopsSapling:"https://www.kasandbox.org/programming-images/avatars/piceratops-sapling.png",piceratopsTree:"https://www.kasandbox.org/programming-images/avatars/piceratops-tree.png",piceratopsUltimate:"https://www.kasandbox.org/programming-images/avatars/piceratops-ultimate.png",primosaurSeed:"https://www.kasandbox.org/programming-images/avatars/primosaur-seed.png",primosaurSeedling:"https://www.kasandbox.org/programming-images/avatars/primosaur-seedling.png",primosaurSapling:"https://www.kasandbox.org/programming-images/avatars/primosaur-sapling.png",primosaurTree:"https://www.kasandbox.org/programming-images/avatars/primosaur-tree.png",primosaurUltimate:"https://www.kasandbox.org/programming-images/avatars/primosaur-ultimate.png",starkySeed:"https://www.kasandbox.org/programming-images/avatars/starky-seed.png",starkySeedling:"https://www.kasandbox.org/programming-images/avatars/starky-seedling.png",starkySapling:"https://www.kasandbox.org/programming-images/avatars/starky-sapling.png",starkyTree:"https://www.kasandbox.org/programming-images/avatars/starky-tree.png",starkyUltimate:"https://www.kasandbox.org/programming-images/avatars/starky-ultimate.png",leafBlue:"https://www.kasandbox.org/programming-images/avatars/leaf-blue.png",leafGreen:"https://www.kasandbox.org/programming-images/avatars/leaf-green.png",leafGray:"https://www.kasandbox.org/programming-images/avatars/leaf-gray.png",leafOrange:"https://www.kasandbox.org/programming-images/avatars/leaf-orange.png",leafRed:"https://www.kasandbox.org/programming-images/avatars/leaf-red.png",leafYellow:"https://www.kasandbox.org/programming-images/avatars/leaf-yellow.png",marcimus:"https://www.kasandbox.org/programming-images/avatars/marcimus.png",marcimusOrange:"https://www.kasandbox.org/programming-images/avatars/marcimus-orange.png",marcimusPurple:"https://www.kasandbox.org/programming-images/avatars/marcimus-purple.png",marcimusRed:"https://www.kasandbox.org/programming-images/avatars/marcimus-red.png",mrPants:"https://www.kasandbox.org/programming-images/avatars/mr-pants.png",mrPantsGreen:"https://www.kasandbox.org/programming-images/avatars/mr-pants-green.png",mrPantsOrange:"https://www.kasandbox.org/programming-images/avatars/mr-pants-orange.png",mrPantsPink:"https://www.kasandbox.org/programming-images/avatars/mr-pants-pink.png",mrPantsPurple:"https://www.kasandbox.org/programming-images/avatars/mr-pants-purple.png",mrPantsWithHat:"https://www.kasandbox.org/programming-images/avatars/mr-pants-with-hats.png",oldSpiceMan:"https://www.kasandbox.org/programming-images/avatars/old-spice-man.png",oldSpiceManBlue:"https://www.kasandbox.org/programming-images/avatars/old-spice-man.png",orangeJuiceSquid:"https://www.kasandbox.org/programming-images/avatars/orange-juice-squid.png",purplePi:"https://www.kasandbox.org/programming-images/avatars/purple-pi.png",purplePiPink:"https://www.kasandbox.org/programming-images/avatars/purple-pi-pink.png",purplePiTeal:"https://www.kasandbox.org/programming-images/avatars/purple-pi-teal.png",questionMark:"https://www.kasandbox.org/programming-images/avatars/questionmark.png",robotFemale1:"https://www.kasandbox.org/programming-images/avatars/robot_female_1.png",robotFemale2:"https://www.kasandbox.org/programming-images/avatars/robot_female_2.png",robotFemale3:"https://www.kasandbox.org/programming-images/avatars/robot_female_3.png",robotMale1:"https://www.kasandbox.org/programming-images/avatars/robot_male_1.png",robotMale2:"https://www.kasandbox.org/programming-images/avatars/robot_male_2.png",robotMale3:"https://www.kasandbox.org/programming-images/avatars/robot_male_3.png",spunkySam:"https://www.kasandbox.org/programming-images/avatars/spunky-sam.png",spunkySamGreen:"https://www.kasandbox.org/programming-images/avatars/spunky-sam-green.png",spunkySamOrange:"https://www.kasandbox.org/programming-images/avatars/spunky-sam-orange.png",spunkySamRed:"https://www.kasandbox.org/programming-images/avatars/spunky-sam-red.png",hopperHappy:"https://www.kasandbox.org/programming-images/creatures/Hopper-Happy.png",hopperCool:"https://www.kasandbox.org/programming-images/creatures/Hopper-Cool.png",hopperJumping:"https://www.kasandbox.org/programming-images/creatures/Hopper-Jumping.png",ohNoes:"https://www.kasandbox.org/programming-images/creatures/OhNoes.png",babyWinston:"https://www.kasandbox.org/programming-images/creatures/BabyWinston.png",winston:"https://www.kasandbox.org/programming-images/creatures/Winston.png",blank:"https://www.kasandbox.org/programming-images/cute/Blank.png",brownBlock:"https://www.kasandbox.org/programming-images/cute/BrownBlock.png",characterBoy:"https://www.kasandbox.org/programming-images/cute/CharacterBoy.png",characterCatGirl:"https://www.kasandbox.org/programming-images/cute/CharacterCatGirl.png",characterHornGirl:"https://www.kasandbox.org/programming-images/cute/CharacterHornGirl.png",characterPinkGirl:"https://www.kasandbox.org/programming-images/cute/CharacterPinkGirl.png",characterPrincessGirl:"https://www.kasandbox.org/programming-images/cute/CharacterPrincessGirl.png",chestClosed:"https://www.kasandbox.org/programming-images/cute/ChestClosed.png",chestLid:"https://www.kasandbox.org/programming-images/cute/ChestLid.png",chestOpen:"https://www.kasandbox.org/programming-images/cute/ChestOpen.png",dirtBlock:"https://www.kasandbox.org/programming-images/cute/ChestClosed.png",doorTallClosed:"https://www.kasandbox.org/programming-images/cute/DoorTallClosed.png",doorTallOpen:"https://www.kasandbox.org/programming-images/cute/DoorTallOpen.png",enemyBug:"https://www.kasandbox.org/programming-images/cute/EnemyBug.png",gemBlue:"https://www.kasandbox.org/programming-images/cute/GemBlue.png",gemGreen:"https://www.kasandbox.org/programming-images/cute/GemGreen.png",gemOrange:"https://www.kasandbox.org/programming-images/cute/GemOrange.png",grassBlock:"https://www.kasandbox.org/programming-images/cute/GrassBlock.png",heart:"https://www.kasandbox.org/programming-images/cute/Heart.png",key:"https://www.kasandbox.org/programming-images/cute/Key.png",plainBlock:"https://www.kasandbox.org/programming-images/cute/PlainBlock.png",rampEast:"https://www.kasandbox.org/programming-images/cute/RampEast.png",rampNorth:"https://www.kasandbox.org/programming-images/cute/RampNorth.png",rampSouth:"https://www.kasandbox.org/programming-images/cute/RampEast.png",rampWest:"https://www.kasandbox.org/programming-images/cute/RampWest.png",rock:"https://www.kasandbox.org/programming-images/cute/Rock.png",roofEast:"https://www.kasandbox.org/programming-images/cute/RampEast.png",roofNorth:"https://www.kasandbox.org/programming-images/cute/RampEast.png",rampSouth:"https://www.kasandbox.org/programming-images/cute/RampEast.png",rampWest:"https://www.kasandbox.org/programming-images/cute/RampEast.png",roofNorthEast:"https://www.kasandbox.org/programming-images/cute/RoofNorthEast.png",roofNorthWest:"https://www.kasandbox.org/programming-images/cute/RoofNorthWest.png",roofSouthEast:"https://www.kasandbox.org/programming-images/cute/RoofSouthEast.png",roofSouthWest:"https://www.kasandbox.org/programming-images/cute/RoofSouthWest.png",selector:"https://www.kasandbox.org/programming-images/cute/Selector.png",shadowEast:"https://www.kasandbox.org/programming-images/cute/ShadowEast.png",shadowWest:"https://www.kasandbox.org/programming-images/cute/ShadowWest.png",shadowNorth:"https://www.kasandbox.org/programming-images/cute/ShadowNorth.png",shadowSouth:"https://www.kasandbox.org/programming-images/cute/ShadowSouth.png",shadowNorthEast:"https://www.kasandbox.org/programming-images/cute/ShadowNorthEast.png",shadowNorthWest:"https://www.kasandbox.org/programming-images/cute/ShadowNorthWest.png",shadowSouthEast:"https://www.kasandbox.org/programming-images/cute/ShadowSouthEast.png",shadowSouthWest:"https://www.kasandbox.org/programming-images/cute/ShadowSouthWest.png",shadowSideWest:"https://www.kasandbox.org/programming-images/cute/ShadowSideWest.png",star:"https://www.kasandbox.org/programming-images/cute/Star.png",stoneBlock:"https://www.kasandbox.org/programming-images/cute/StoneBlock.png",stoneBlockTall:"https://www.kasandbox.org/programming-images/cute/StoneBlockTall.png",treeShort:"https://www.kasandbox.org/programming-images/cute/TreeShort.png",treeTall:"https://www.kasandbox.org/programming-images/cute/TreeTall.png",treeUgly:"https://www.kasandbox.org/programming-images/cute/TreeUgly.png",wallBlock:"https://www.kasandbox.org/programming-images/cute/WallBlock.png",wallBlockTall:"https://www.kasandbox.org/programming-images/cute/WallBlockTall.png",waterBlock:"https://www.kasandbox.org/programming-images/cute/WaterBlock.png",windowTall:"https://www.kasandbox.org/programming-images/cute/WindowTall.png",woodBlock:"https://www.kasandbox.org/programming-images/cute/WoodBlock.png",background:"https://www.kasandbox.org/programming-images/space/background.png",beetleship:"https://www.kasandbox.org/programming-images/space/beetleship.png",collisioncircle:"https://www.kasandbox.org/programming-images/space/collisioncircle.png",girl1:"https://www.kasandbox.org/programming-images/space/girl1.png",girl2:"https://www.kasandbox.org/programming-images/space/girl2.png",girl3:"https://www.kasandbox.org/programming-images/space/girl3.png",girl4:"https://www.kasandbox.org/programming-images/space/girl4.png",girl5:"https://www.kasandbox.org/programming-images/space/girl5.png",healthHeart:"https://www.kasandbox.org/programming-images/space/healthheart.png",minus:"https://www.kasandbox.org/programming-images/space/minus.png",octopus:"https://www.kasandbox.org/programming-images/space/octopus.png",planet:"https://www.kasandbox.org/programming-images/space/planet.png",plus:"https://www.kasandbox.org/programming-images/space/plus.png",rocketShip:"https://www.kasandbox.org/programming-images/space/rocketship.png",star2:"https://www.kasandbox.org/programming-images/space/star.png",zero:"https://www.kasandbox.org/programming-images/space/0.png",one:"https://www.kasandbox.org/programming-images/space/1.png",two:"https://www.kasandbox.org/programming-images/space/2.png",three:"https://www.kasandbox.org/programming-images/space/3.png",four:"https://www.kasandbox.org/programming-images/space/4.png",five:"https://www.kasandbox.org/programming-images/space/5.png",six:"https://www.kasandbox.org/programming-images/space/6.png",seven:"https://www.kasandbox.org/programming-images/space/7.png",eight:"https://www.kasandbox.org/programming-images/space/8.png",nine:"https://www.kasandbox.org/programming-images/space/9.png"};KAPhy.Draw.loadImage||(KAPhy.Draw.loadImage=function(a,e){if(0===arguments.length||arguments.length>2)console.warn("KAPhy Warning - KAPhy.Draw.loadImage() takes 1 or 2 arguments.");else if(Images[a]){var s=new Image;s.onload=e,s.src=Images[a]}else console.warn("KAPhy Warning - Tried to load invalid image.")}),KAPhy.Draw.loadImageSet||(KAPhy.Draw.loadImageSet=function(a,e){if(0!==arguments.length)for(var s=0,n=[],t=0;t<a.length;t++)KAPhy.Draw.loadImage(a[t],function(){n.push(this),++s>=a.length&&e.call(n)});else console.warn("KAPhy Warning - KAPhy.Draw.loadImageSet() takes at least 1 argument.")}),KAPhy.Draw.popMatrix||(KAPhy.Draw.popMatrix=function(){if(KAPhy.Canvas.configured)if(KAPhy.Draw.shapeOn)console.warn("KAPhy Warning - You cannot use transformation commands in shape mode.");else{var a=KAPhy.Canvas.context.fillStyle,e=KAPhy.Canvas.context.strokeStyle,s=KAPhy.Canvas.context.lineWidth,n=KAPhy.Canvas.context.lineCap,t=KAPhy.Canvas.context.lineJoin,o=KAPhy.Canvas.context.globalAlpha,r=KAPhy.Canvas.context.miterLimit,i=KAPhy.Canvas.context.font,h=KAPhy.Canvas.context.textAlign,c=KAPhy.Canvas.context.textBaseline,y=KAPhy.Canvas.context.imageSmoothingEnabled;KAPhy.Canvas.context.restore(),KAPhy.Canvas.context.fillStyle=a,KAPhy.Canvas.context.strokeStyle=e,KAPhy.Canvas.context.lineWidth=s,KAPhy.Canvas.context.lineCap=n,KAPhy.Canvas.context.lineJoin=t,KAPhy.Canvas.context.globalAlpha=o,KAPhy.Canvas.context.miterLimit=r,KAPhy.Canvas.context.font=i,KAPhy.Canvas.context.textAlign=h,KAPhy.Canvas.context.textBaseline=c,KAPhy.Canvas.context.imageSmoothingEnabled=y}else console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.pushMatrix||(KAPhy.Draw.pushMatrix=function(){KAPhy.Canvas.configured?KAPhy.Draw.shapeOn?console.warn("KAPhy Warning - You cannot use transformation commands in shape mode."):KAPhy.Canvas.context.save():console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.resetMatrix||(KAPhy.Draw.resetMatrix=function(){KAPhy.Canvas.configured?KAPhy.Draw.shapeOn?console.warn("KAPhy Warning - You cannot use transformation commands in shape mode."):KAPhy.Canvas.context.setTransform(1,0,0,1,0,0):console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.rotate||(KAPhy.Draw.rotate=function(a){KAPhy.Canvas.configured?KAPhy.Draw.shapeOn?console.warn("KAPhy Warning - You can't use transformation commands when in shape mode."):1===arguments.length?KAPhy.Canvas.context.rotate(a):console.warn("KAPhy Warning - KAPhy.Draw.rotate() takes 1 argument."):console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.scale||(KAPhy.Draw.scale=function(a,e){KAPhy.Canvas.configured?KAPhy.Draw.shapeOn?console.warn("KAPhy Warning - You can't use transformation commands when in shape mode."):0===arguments.length||arguments.length>2?console.warn("KAPhy Warning - KAPhy.Draw.scale() takes 1 - 2 arguments."):KAPhy.Canvas.context.scale(a,e||a):console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.skew||(KAPhy.Draw.skew=function(a,e){KAPhy.Canvas.configured?KAPhy.Draw.shapeOn?console.warn("KAPhy Warning - You can't use transformation commands when in shape mode."):0===arguments.length||arguments.length>2?console.warn("KAPhy Warning - KAPhy.Draw.skew() takes 1 - 2 arguments."):KAPhy.Canvas.context.transform(1,a,e||0,1,0,0):console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.translate||(KAPhy.Draw.translate=function(a,e){KAPhy.Canvas.configured?KAPhy.Draw.shapeOn?console.warn("KAPhy Warning - You can't use transformation commands when in shape mode."):0===arguments.length||arguments.length>2?console.warn("KAPhy Warning - KAPhy.Draw.translate() takes 1 - 2 arguments."):KAPhy.Canvas.context.translate(KAPhy.Canvas.toPixels(a||0),KAPhy.Canvas.toPixels(e||0)):console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.ellipseMode||(KAPhy.Draw.ellipseMode=function(a){KAPhy.Canvas.configured?a!==CENTER&&a!==CORNER&&a!==CORNERS&&a!==RADIUS||(KAPhy.Draw.currentEllipseMode=a):console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.getEllipseMode||(KAPhy.Draw.getEllipseMode=function(){if(KAPhy.Canvas.configured)return KAPhy.Draw.currentEllipseMode;console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.getImageMode||(KAPhy.Draw.getImageMode=function(){if(KAPhy.Canvas.configured)return KAPhy.Draw.currentImageMode;console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.getRectMode||(KAPhy.Draw.getRectMode=function(){if(KAPhy.Canvas.configured)return KAPhy.Draw.currentRectMode;console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.getStrokeCap||(KAPhy.Draw.getStrokeCap=function(){if(KAPhy.Canvas.configured)return KAPhy.Canvas.context.lineCap;console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.getStrokeJoin||(KAPhy.Draw.getStrokeJoin=function(){if(KAPhy.Canvas.configured)return KAPhy.Canvas.context.lineJoin;console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.getStrokeWeight||(KAPhy.Draw.getStrokeWeight=function(){if(KAPhy.Canvas.configured)return KAPhy.Canvas.toCanvasUnits(KAPhy.Canvas.context.lineWidth||0);console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.getTextAlign||(KAPhy.Draw.getTextAlign=function(){if(KAPhy.Canvas.configured)return arguments.length>0&&console.warn("KAPhy Warning - KAPhy.Draw.getTextAlign() takes 0 arguments."),KAPhy.Canvas.context.textAlign;console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.getTextBaseline||(KAPhy.Draw.getTextBaseline=function(a,e){if(KAPhy.Canvas.configured)return 0!==arguments.length&&console.warn("KAPhy Warning - KAPhy.Draw.textAlign() takes 0 arguments."),KAPhy.Canvas.context.textBaseline;console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.getTextFont||(KAPhy.Draw.getTextFont=function(){if(KAPhy.Canvas.configured){var a=KAPhy.Canvas.context.font.split(" ");return KAPhy.Canvas.toCanvasUnits(a[a.length-1])}console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.getTextLineSpacing||(KAPhy.Draw.getTextLineSpacing=function(){if(KAPhy.Canvas.configured)return 0!==arguments.length&&console.warn("KAPhy Warning - KAPhy.Draw.getTextLineSpacing() takes 0 argument."),KAPhy.Draw.currentTextLineSpacing;console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.getTextSize||(KAPhy.Draw.getTextSize=function(a){if(KAPhy.Canvas.configured){var e=KAPhy.Canvas.context.font.split(" ");return KAPhy.Canvas.toCanvasUnits(parseInt(e[e.length-2]))}console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.imageMode||(KAPhy.Draw.imageMode=function(a){KAPhy.Canvas.configured?a!==CENTER&&a!==CORNER&&a!==CORNERS&&a!==RADIUS||(KAPhy.Draw.currentImageMode=a):console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.loadFont||(KAPhy.Draw.loadFont=function(a,e){var s=document.createElement("link");s.rel="stylesheet",s.href="https://fonts.googleapis.com/css?family="+a,s.onload=e,document.head.appendChild(s)}),KAPhy.Draw.loadFontSet||(KAPhy.Draw.loadFontSet=function(a,e){for(var s=0,n=0;n<a.length;n++){var t=document.createElement("link");t.rel="stylesheet",t.href="https://fonts.googleapis.com/css?family="+font,t.onload=function(){++s>=a.length-1&&e&&e()},document.head.appendChild(t)}}),KAPhy.Draw.rectMode||(KAPhy.Draw.rectMode=function(a){KAPhy.Canvas.configured?a!==CENTER&&a!==CORNER&&a!==CORNERS&&a!==RADIUS||(KAPhy.Draw.currentRectMode=a):console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.strokeCap||(KAPhy.Draw.strokeCap=function(a){KAPhy.Canvas.configured?a!==ROUND&&a!==SQUARE&&a!==PROJECT||(KAPhy.Canvas.context.lineCap=a):console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.strokeJoin||(KAPhy.Draw.strokeJoin=function(a){KAPhy.Canvas.configured?a!==MITER&&a!==ROUND&&a!==BEVEL||(KAPhy.Canvas.context.lineJoin=a):console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.strokeWeight||(KAPhy.Draw.strokeWeight=function(a){KAPhy.Canvas.configured?KAPhy.Draw.shapeOn?console.warn("KAPhy Warning - You can't use color commands when in shape mode."):(arguments.length>1&&console.warn("KAPhy Warning - KAPhy.Draw.strokeWeight() takes 0 or 1 arguments."),KAPhy.Canvas.context.lineWidth=KAPhy.Canvas.toPixels(a||0)):console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.textAlign||(KAPhy.Draw.textAlign=function(a,e){KAPhy.Canvas.configured?(arguments.length>2&&console.warn("KAPhy Warning - KAPhy.Draw.textAlign() takes 0 - 2 arguments."),KAPhy.Canvas.context.textAlign=a||"left",e&&(KAPhy.Canvas.context.textBaseline=e)):console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.textFont||(KAPhy.Draw.textFont=function(a,e,s){if(KAPhy.Canvas.configured){var n=KAPhy.Canvas.context.font.split(" ");KAPhy.Canvas.context.font=(s?s+" ":"")+Math.round(e?KAPhy.Canvas.toPixels(e):parseInt(n[n.length-2]))+"px "+a}else console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.textLineSpacing||(KAPhy.Draw.textLineSpacing=function(a){KAPhy.Canvas.configured?(1!==arguments.length&&console.warn("KAPhy Warning - KAPhy.Draw.textLineSpacing() takes 1 argument."),KAPhy.Draw.currentTextLineSpacing=0===a?0:a||.4):console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.textSize||(KAPhy.Draw.textSize=function(a){if(KAPhy.Canvas.configured){var e=KAPhy.Canvas.context.font.split(" ");KAPhy.Canvas.context.font=(3===e.length?e[0]+" ":"")+KAPhy.Canvas.toPixels(Math.round(a))+"px "+e[e.length-1]}else console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.arc||(KAPhy.Draw.arc=function(a,e,s,n,t,o){if(KAPhy.Canvas.configured)if(KAPhy.Draw.shapeOn)console.warn("KAPhy Warning - You can't use other shape commands when in shape mode.");else{var r=a,i=e,h=s,c=n;switch(KAPhy.Draw.currentEllipseMode){case CORNER:r=a-s/2,i=e-n/2;break;case CORNERS:r=(a+s)/2,i=(e+n)/2,h=s-a,c=n-e;break;case RADIUS:h=2*s,c=2*n}KAPhy.Canvas.configured&&(r=KAPhy.Canvas.toPixels(r),i=KAPhy.Canvas.toPixels(i),h=KAPhy.Canvas.toPixels(h),c=KAPhy.Canvas.toPixels(c)),KAPhy.Canvas.context.beginPath(),KAPhy.Canvas.context.ellipse(r,i,h,c,0,t,o),KAPhy.Canvas.context.lineTo(r,i),KAPhy.Canvas.context.fill(),KAPhy.Canvas.context.beginPath(),KAPhy.Canvas.context.ellipse(r,i,h,c,0,t,o),KAPhy.Canvas.context.stroke()}else console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.background||(KAPhy.Draw.background=function(a,e,s,n){if(KAPhy.Canvas.configured)if(KAPhy.Draw.shapeOn)console.warn("KAPhy Warning - You can't use other shape commands when in shape mode.");else{KAPhy.Canvas.context.fillStyle;switch(KAPhy.Canvas.context.save(),KAPhy.Canvas.context.resetTransform(),arguments.length){case 0:KAPhy.Draw.fill();break;case 1:KAPhy.Draw.fill(a);break;case 2:KAPhy.Draw.fill(a,e);break;case 3:KAPhy.Draw.fill(a,e,s);break;case 4:KAPhy.Draw.fill(a,e,s,n)}KAPhy.Canvas.context.fillRect(0,0,KAPhy.Canvas.element.width,KAPhy.Canvas.element.height),KAPhy.Canvas.context.restore()}else console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.beginShape||(KAPhy.Draw.beginShape=function(){KAPhy.Draw.shapeOn?console.warn("KAPhy Warning - Cannot reinitialize shape."):(KAPhy.Canvas.context.beginPath(),KAPhy.Draw.shapeOn=!0)}),KAPhy.Draw.bezierVertex||(KAPhy.Draw.bezierVertex=function(a,e,s,n,t,o){KAPhy.Canvas.configured?KAPhy.Draw.shapeOn?KAPhy.Canvas.context.bezierCurveTo(KAPhy.Canvas.toPixels(a),KAPhy.Canvas.toPixels(e),KAPhy.Canvas.toPixels(s),KAPhy.Canvas.toPixels(n),KAPhy.Canvas.toPixels(t),KAPhy.Canvas.toPixels(o)):console.warn("KAPhy Warning - You can only use KAPhy.Draw.bezierVertex() in shape mode."):console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.ellipse||(KAPhy.Draw.ellipse=function(a,e,s,n){if(KAPhy.Canvas.configured)if(KAPhy.Draw.shapeOn)console.warn("KAPhy Warning - You can't use other shape commands when in shape mode.");else{KAPhy.Canvas.context.beginPath();var t=a,o=e,r=s,i=n;switch(KAPhy.Draw.currentEllipseMode){case CORNER:t=a-s/2,o=e-n/2;break;case CORNERS:t=(a+s)/2,o=(e+n)/2,r=s-a,i=n-e;break;case RADIUS:r=2*s,i=2*n}KAPhy.Canvas.configured&&(t=KAPhy.Canvas.toPixels(t),o=KAPhy.Canvas.toPixels(o),r=KAPhy.Canvas.toPixels(r/2),i=KAPhy.Canvas.toPixels(i/2)),KAPhy.Canvas.context.ellipse(t,o,r,i,0,0,6.3),KAPhy.Canvas.context.fill(),KAPhy.Canvas.context.stroke()}else console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.ellipseSection||(KAPhy.Draw.ellipseSection=function(a,e,s,n,t,o){if(KAPhy.Canvas.configured)if(KAPhy.Draw.shapeOn)console.warn("KAPhy Warning - You can't use other shape commands when in shape mode.");else{KAPhy.Canvas.context.beginPath();var r=a,i=e,h=s,c=n;switch(KAPhy.Draw.currentEllipseMode){case CORNER:r=a-s/2,i=e-n/2;break;case CORNERS:r=(a+s)/2,i=(e+n)/2,h=s-a,c=n-e;break;case RADIUS:h=2*s,c=2*n}KAPhy.Canvas.configured&&(r=KAPhy.Canvas.toPixels(r),i=KAPhy.Canvas.toPixels(i),h=KAPhy.Canvas.toPixels(h),c=KAPhy.Canvas.toPixels(c)),KAPhy.Canvas.context.ellipse(r,i,h,c,0,t,o),KAPhy.Canvas.context.fill(),KAPhy.Canvas.context.stroke()}else console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.endShape||(KAPhy.Draw.endShape=function(){KAPhy.Draw.shapeOn?(KAPhy.Canvas.context.fill(),KAPhy.Canvas.context.stroke(),KAPhy.Draw.shapeOn=!1):console.warn("KAPhy Warning - Cannot end nonexistent shape.")}),KAPhy.Draw.line||(KAPhy.Draw.line=function(a,e,s,n){KAPhy.Canvas.configured?KAPhy.Draw.shapeOn?console.warn("KAPhy Warning - You can't use other shape commands when in shape mode."):(KAPhy.Canvas.context.beginPath(),KAPhy.Canvas.context.moveTo(a,e),KAPhy.Canvas.context.lineTo(s,n),KAPhy.Canvas.context.stroke()):console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.point||(KAPhy.Draw.point=function(a,e){KAPhy.Canvas.configured?KAPhy.Draw.shapeOn?console.warn("KAPhy Warning - You can't use other shape commands when in shape mode."):(KAPhy.Canvas.context.beginPath(),KAPhy.Canvas.context.moveTo(a,e),KAPhy.Canvas.context.lineTo(a,e),KAPhy.Canvas.context.stroke()):console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.poly||(KAPhy.Draw.poly=function(){if(KAPhy.Canvas.configured)if(KAPhy.Draw.shapeOn)console.warn("KAPhy Warning - You can't use other shape commands when in shape mode.");else{KAPhy.Canvas.context.beginPath(),KAPhy.Canvas.context.moveTo(KAPhy.Canvas.toPixels(arguments[0]),KAPhy.Canvas.toPixels(arguments[1]));for(var a=2;a<arguments.length;a+=2)KAPhy.Canvas.context.lineTo(KAPhy.Canvas.toPixels(arguments[a]),KAPhy.Canvas.toPixels(arguments[a+1]));KAPhy.Canvas.context.closePath(),KAPhy.Canvas.context.fill(),KAPhy.Canvas.context.stroke()}else console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.quadVertex||(KAPhy.Draw.quadVertex=function(a,e,s,n){KAPhy.Canvas.configured?KAPhy.Draw.shapeOn?KAPhy.Canvas.context.quadraticCurveTo(KAPhy.Canvas.toPixels(a),KAPhy.Canvas.toPixels(e),KAPhy.Canvas.toPixels(s),KAPhy.Canvas.toPixels(n)):console.warn("KAPhy Warning - You can only use KAPhy.Draw.quadVertex() in shape mode."):console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.rect||(KAPhy.Draw.rect=function(a,e,s,n,t,o,r,i){if(KAPhy.Canvas.configured)if(KAPhy.Draw.shapeOn)console.warn("KAPhy Warning - You can't use other shape commands when in shape mode.");else if(arguments.length>8||arguments.length<4)console.warn("KAPhy Warning - KAPhy.Draw.rect() takes 4 - 8 arguments.");else{var h=a,c=e,y=s,P=n;switch(KAPhy.Draw.currentRectMode){case CORNERS:y=s-a,P=n-e;break;case RADIUS:h=a+s/2,c=e+n/2,y=2*s,P=2*n;break;case CENTER:h=a-s/2,c=e-n/2}h=KAPhy.Canvas.toPixels(h),c=KAPhy.Canvas.toPixels(c),y=KAPhy.Canvas.toPixels(y),P=KAPhy.Canvas.toPixels(P),t=t||0,o=o||t,r=r||t,i=i||t,KAPhy.Canvas.context.beginPath(),KAPhy.Canvas.context.moveTo(h+KAPhy.Canvas.toPixels(t),c),KAPhy.Canvas.context.lineTo(h+y-KAPhy.Canvas.toPixels(o),c),KAPhy.Canvas.context.quadraticCurveTo(h+y,c,h+y,c+KAPhy.Canvas.toPixels(o)),KAPhy.Canvas.context.lineTo(h+y,c+P-KAPhy.Canvas.toPixels(r)),KAPhy.Canvas.context.quadraticCurveTo(h+y,c+P,h+y-KAPhy.Canvas.toPixels(r),c+P),KAPhy.Canvas.context.lineTo(h+KAPhy.Canvas.toPixels(i),c+P),KAPhy.Canvas.context.quadraticCurveTo(h,c+P,h,c+P-KAPhy.Canvas.toPixels(i)),KAPhy.Canvas.context.lineTo(h,c+KAPhy.Canvas.toPixels(t)),KAPhy.Canvas.context.quadraticCurveTo(h,c,h+KAPhy.Canvas.toPixels(t),c),KAPhy.Canvas.context.closePath(),KAPhy.Canvas.context.fill(),KAPhy.Canvas.context.stroke()}else console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.text||(KAPhy.Draw.text=function(a,e,s){if(KAPhy.Canvas.configured)if(KAPhy.Draw.shapeOn)console.warn("KAPhy Warning - You can't use other shape commands when in shape mode.");else{(0===arguments.length||arguments.length>3)&&console.warn("KAPhy Warning - KAPhy.Draw.text() takes 1 - 3 arguments.");var n=KAPhy.Draw.getTextSize(),t=a.split("\n"),o=0;"middle"===KAPhy.Draw.getTextBaseline().toLowerCase()&&(o=-.5*(t.length-1)*n*(1+KAPhy.Draw.currentTextLineSpacing));for(var r=0;r<t.length;r++)KAPhy.Canvas.context.fillText(t[r],KAPhy.Canvas.toPixels(e||0),o+KAPhy.Canvas.toPixels(s||0)+r*n*(1+KAPhy.Draw.currentTextLineSpacing))}else console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Draw.vertex||(KAPhy.Draw.vertex=function(a,e){KAPhy.Canvas.configured?KAPhy.Draw.shapeOn?KAPhy.Canvas.context.lineTo(KAPhy.Canvas.toPixels(a),KAPhy.Canvas.toPixels(e)):console.warn("KAPhy Warning - You can only use KAPhy.Draw.vertex() in shape mode."):console.warn("KAPhy Warning - You must use KAPhy.Canvas.configure(); before you can draw!")}),KAPhy.Physics.Circle=function(a){this.pos=a.pos||new KAPhy.Physics.Vector2(a.x||0,a.y||0),this.vel=a.vel||new KAPhy.Physics.Vector2(a.vx||0,a.vy||0),this.pos=new KAPhy.Physics.Vector2(KAPhy.Canvas.toPixels(this.pos.x),KAPhy.Canvas.toPixels(this.pos.y)),this.vel=new KAPhy.Physics.Vector2(KAPhy.Canvas.toPixels(this.vel.x),KAPhy.Canvas.toPixels(this.vel.y)),this.bcf=a.bcf||.75,this.rad=a.rad||15,this.constraints=[],this.asleep=!1,this.posAdjustments=[],this.mass=a.mass||1,this.fixed=a.fixed||!1,this.buoyancyForce=0,this.waterDrag=1},KAPhy.Physics.Circle.prototype.update=function(){if(this.fixed)return this.asleep=!1,void(this.vel=new KAPhy.Physics.Vector2);(this.vel.magSq()>KAPhy.Physics.sleepThreshold*KAPhy.Physics.sleepThreshold||this.buoyancyForce>0)&&(this.asleep=!1),this.pos.add(this.vel),this.vel.y+=KAPhy.Canvas.toPixels(KAPhy.Physics.gravityForce-this.buoyancyForce),this.vel.mult(this.asleep?KAPhy.Physics.airResistanceSleeping:this.waterDrag*KAPhy.Physics.airResistance),this.buoyancyForce=0,this.waterDrag=1,this.manageAdjustments()},KAPhy.Physics.Circle.prototype.draw=function(){KAPhy.Draw.ellipse(KAPhy.Canvas.toCanvasUnits(this.pos.x),KAPhy.Canvas.toCanvasUnits(this.pos.y),2*this.rad,2*this.rad)},KAPhy.Physics.Circle.prototype.display=function(){this.move&&this.move(),this.update(),this.draw()},KAPhy.Physics.Circle.prototype.manageAdjustments=function(){if(0!==this.posAdjustments.length){for(var a=new KAPhy.Physics.Vector2,e=0;e<this.posAdjustments.length;e++)a.add(this.posAdjustments[e]);this.pos=KAPhy.Physics.Vector2.lerp(this.pos,KAPhy.Physics.Vector2.div(a,this.posAdjustments.length),KAPhy.Physics.constraintAdjustment),this.posAdjustments=[]}},KAPhy.Physics.Circle.prototype.trySleep=function(){KAPhy.Physics.Vector2.magSq(this.vel)<KAPhy.Physics.sleepThreshold*KAPhy.Physics.sleepThreshold&&(this.asleep=!0)},KAPhy.Physics.Circle.prototype.applyForce=function(a){this.vel=KAPhy.Physics.Vector2.add(this.vel,KAPhy.Physics.Vector2.div(a,this.mass))},KAPhy.Physics.Circle.prototype.moveTowards=function(a,e){this.applyForce(KAPhy.Physics.Vector2.mult(KAPhy.Physics.Vector2.normalize(KAPhy.Physics.Vector2.sub(a,this.pos)),e))},KAPhy.Physics.Circle.prototype.moveFrom=function(a,e){this.applyForce(KAPhy.Physics.Vector2.mult(KAPhy.Physics.Vector2.normalize(KAPhy.Physics.Vector2.sub(this.pos,a)),e))},KAPhy.Physics.Circle.prototype.collideLine=function(a){var e=this.pos.canvasMap(),s=this.vel.canvasMap(),n=a.one.canvasMap(),t=a.two.canvasMap(),o=KAPhy.Physics.Vector2.sub(e,s),r=!1;if(n.x!==t.x&&n.y!==t.y){if(!KAPhy.Physics.Collision.circleCollidingLine(n,t,e,this.rad+a.rad)){if(!KAPhy.Physics.Collision.intersecting(n,t,e,o))return;r=!0}if(KAPhy.Physics.Collision.intersecting(e,KAPhy.Physics.Vector2.reflect(e,n,t),n,t)){i=KAPhy.Physics.Collision.intersection(o,KAPhy.Physics.Vector2.reflect(o,n,t),n,t);this.vel=KAPhy.Physics.Vector2.mult(KAPhy.Physics.Vector2.sub(i,KAPhy.Physics.Vector2.reflect(KAPhy.Physics.Vector2.sub(i,s),i,KAPhy.Physics.Vector2.add(i,new KAPhy.Physics.Vector2(1,KAPhy.Physics.Equation.PM(n,t))))),-a.bcf*this.bcf).canvasUnmap(),this.pos=KAPhy.Physics.Vector2.add(i,KAPhy.Physics.Vector2.mult(KAPhy.Physics.Vector2.normalize(new KAPhy.Physics.Vector2(1,KAPhy.Physics.Equation.PM(n,t))),(this.rad+a.rad+.5)*(e.y>i.y?-1:1)*(n.x>t.x?-1:1)*(n.y>t.y?-1:1)*(r?-1:1))).canvasUnmap()}else{var i=KAPhy.Physics.Vector2.distSq(e,n)<KAPhy.Physics.Vector2.distSq(e,t)?n:t;this.vel=KAPhy.Physics.Vector2.mult(KAPhy.Physics.Vector2.sub(KAPhy.Physics.Vector2.reflect(KAPhy.Physics.Vector2.sub(o,s),i,o),o),a.bcf*this.bcf).canvasUnmap(),this.pos=KAPhy.Physics.Vector2.sub(i,KAPhy.Physics.Vector2.mult(KAPhy.Physics.Vector2.normalize(KAPhy.Physics.Vector2.sub(i,o)),this.rad+a.rad+.5)).canvasUnmap()}this.trySleep()}},KAPhy.Physics.Circle.prototype.collideStaticDynamic=function(a){a.pos=KAPhy.Physics.Vector2.lerp(a.pos.canvasMap(),KAPhy.Physics.Vector2.add(this.pos.canvasMap(),KAPhy.Physics.Vector2.mult(KAPhy.Physics.Vector2.normalize(KAPhy.Physics.Vector2.sub(a.pos.canvasMap(),this.pos.canvasMap())),this.rad+a.rad)),KAPhy.Physics.circleAdjustment).canvasUnmap(),a.vel=KAPhy.Physics.Vector2.mult(KAPhy.Physics.Vector2.sub(KAPhy.Physics.Vector2.reflect(KAPhy.Physics.Vector2.sub(a.pos.canvasMap(),a.vel.canvasMap()),this.pos.canvasMap(),a.pos.canvasMap()),a.pos.canvasMap()),this.bcf*a.bcf).canvasUnmap(),a.pos=KAPhy.Physics.Vector2.add(a.pos,a.vel)},KAPhy.Physics.Circle.prototype.collideDynamicStatic=function(a){this.pos=KAPhy.Physics.Vector2.lerp(this.pos.canvasMap(),KAPhy.Physics.Vector2.add(a.pos.canvasMap(),KAPhy.Physics.Vector2.mult(KAPhy.Physics.Vector2.normalize(KAPhy.Physics.Vector2.sub(this.pos.canvasMap(),a.pos.canvasMap())),this.rad+a.rad)),KAPhy.Physics.circleAdjustment).canvasUnmap(),this.vel=KAPhy.Physics.Vector2.mult(KAPhy.Physics.Vector2.sub(KAPhy.Physics.Vector2.reflect(KAPhy.Physics.Vector2.sub(this.pos.canvasMap(),this.vel.canvasMap()),a.pos.canvasMap(),this.pos.canvasMap()),this.pos.canvasMap()),this.bcf*a.bcf).canvasUnmap(),this.pos=KAPhy.Physics.Vector2.add(this.pos,this.vel)},KAPhy.Physics.Circle.prototype.collideDynamicDynamic=function(a){var e=KAPhy.Physics.Vector2.mid(this.pos,a.pos),s=KAPhy.Physics.Vector2.normalize(KAPhy.Physics.Vector2.sub(this.pos,a.pos));this.pos=KAPhy.Physics.Vector2.lerp(this.pos,KAPhy.Physics.Vector2.add(e,KAPhy.Physics.Vector2.mult(s,this.rad+a.rad)),KAPhy.Physics.circleAdjustment),a.pos=KAPhy.Physics.Vector2.lerp(a.pos,KAPhy.Physics.Vector2.sub(e,KAPhy.Physics.Vector2.mult(s,this.rad+a.rad)),KAPhy.Physics.circleAdjustment);var n=KAPhy.Physics.Vector2.dot(this.vel,s),t=KAPhy.Physics.Vector2.dot(a.vel,s),o=t*a.mass/this.mass,r=n*this.mass/a.mass;this.vel.add(KAPhy.Physics.Vector2.mult(s,(o-n)*this.bcf*a.bcf)),a.vel.add(KAPhy.Physics.Vector2.mult(s,(r-t)*this.bcf*a.bcf))},KAPhy.Physics.Circle.prototype.collideCircle=function(a){this.fixed&&a.fixed||KAPhy.Physics.Vector2.distSq(this.pos.canvasMap(),a.pos.canvasMap())>(this.rad+a.rad)*(this.rad+a.rad)||(this.fixed?this.collideStaticDynamic(a):a.fixed?this.collideDynamicStatic(a):this.collideDynamicDynamic(a))},KAPhy.Physics.Constraint||(KAPhy.Physics.Constraint=function(a){this.one=a.one,this.two=a.two,this.rigidity=a.rigidity||a.rgd||1/3,this.length=a.length||100,this.one.constraints.push(this),this.two.constraints.push(this)},KAPhy.Physics.Constraint.prototype.springEffect=function(){var a=KAPhy.Physics.Vector2.dist(this.one.pos.canvasMap(),this.two.pos.canvasMap()),e=KAPhy.Physics.Vector2.mult(KAPhy.Physics.Vector2.normalize(KAPhy.Physics.Vector2.sub(this.one.pos.canvasMap(),this.two.pos.canvasMap())),this.rigidity*(a/this.length-1));this.one.applyForce(KAPhy.Physics.Vector2.mult(e,-1).canvasUnmap()),this.two.applyForce(e.canvasUnmap())},KAPhy.Physics.Constraint.prototype.forceCompensate=function(){KAPhy.Physics.Vector2.dist(this.one.pos.canvasMap(),this.two.pos.canvasMap());var a=KAPhy.Physics.Vector2.mult(KAPhy.Physics.Vector2.normalize(KAPhy.Physics.Vector2.sub(this.one.pos.canvasMap(),this.two.pos.canvasMap())),this.length/2),e=KAPhy.Physics.Vector2.mid(this.one.pos.canvasMap(),this.two.pos.canvasMap());this.one.fixed||this.one.posAdjustments.push(KAPhy.Physics.Vector2.add(e,a).canvasUnmap()),this.two.fixed||this.two.posAdjustments.push(KAPhy.Physics.Vector2.sub(e,a).canvasUnmap())},KAPhy.Physics.Constraint.prototype.draw=function(){KAPhy.Draw.strokeWeight(3),KAPhy.Draw.stroke(0,0,0),KAPhy.Draw.line(this.one.pos.x,this.one.pos.y,this.two.pos.x,this.two.pos.y)},KAPhy.Physics.Constraint.prototype.display=function(){this.update&&this.update(),this.draw()}),KAPhy.Physics.Line=function(a){this.one=a.one||new KAPhy.Physics.Vector2,this.two=a.two||new KAPhy.Physics.Vector2,this.one=new KAPhy.Physics.Vector2(KAPhy.Canvas.toPixels(this.one.x),KAPhy.Canvas.toPixels(this.one.y)),this.two=new KAPhy.Physics.Vector2(KAPhy.Canvas.toPixels(this.two.x),KAPhy.Canvas.toPixels(this.two.y)),this.bcf=a.bcf||.75,this.rad=a.rad||4},KAPhy.Physics.Line.prototype.draw=function(){var a=KAPhy.Draw.getStrokeWeight();KAPhy.Draw.strokeWeight(2*this.rad),KAPhy.Draw.line(this.one.x,this.one.y,this.two.x,this.two.y),KAPhy.Draw.strokeWeight(a)},KAPhy.Physics.Collision||(KAPhy.Physics.Collision={intersection:function(a,e,s,n){var t=(KAPhy.Physics.Equation.B(s,n)-KAPhy.Physics.Equation.B(a,e))/(KAPhy.Physics.Equation.M(a,e)-KAPhy.Physics.Equation.M(s,n));return new KAPhy.Physics.Vector2(t,KAPhy.Physics.Equation.M(a,e)*t+KAPhy.Physics.Equation.B(a,e))},intersecting:function(a,e,s,n){var t=KAPhy.Physics.Collision.intersection(a,e,s,n);return t.x>=Math.min(a.x,e.x)&&t.x<=Math.max(a.x,e.x)&&t.x>=Math.min(s.x,n.x)&&t.x<=Math.max(s.x,n.x)},circleCollidingLine:function(a,e,s,n){if(KAPhy.Physics.Vector2.magSq(KAPhy.Physics.Vector2.sub(a,s))<=n*n||KAPhy.Physics.Vector2.magSq(KAPhy.Physics.Vector2.sub(e,s))<=n*n)return!0;var t=(KAPhy.Physics.Equation.B(a,e)-KAPhy.Physics.Equation.TB(KAPhy.Physics.Equation.PM(a,e),s))/(KAPhy.Physics.Equation.PM(a,e)-KAPhy.Physics.Equation.M(a,e));return t>Math.min(a.x,e.x)&&t<Math.max(a.x,e.x)&&KAPhy.Physics.Vector2.magSq(KAPhy.Physics.Vector2.sub(new KAPhy.Physics.Vector2(t,KAPhy.Physics.Equation.M(a,e)*t+KAPhy.Physics.Equation.B(a,e)),s))<n*n}}),KAPhy.Physics.Equation||(KAPhy.Physics.Equation={M:function(a,e){return(a.y-e.y)/(a.x-e.x)},B:function(a,e){return a.y-(a.y-e.y)/(a.x-e.x)*a.x},PM:function(a,e){return(e.x-a.x)/(a.y-e.y)},TB:function(a,e){return e.y-a*e.x}}),KAPhy.Physics.Vector2||(KAPhy.Physics.Vector2=function(a,e){this.x=a||0,this.y=e||0}),KAPhy.Physics.Bungee||(KAPhy.Physics.Bungee=function(a){KAPhy.Physics.Constraint.call(this,a)},KAPhy.Physics.Bungee.prototype=Object.create(KAPhy.Physics.Constraint.prototype),KAPhy.Physics.Bungee.prototype.update=function(){KAPhy.Physics.Vector2.dist(this.one.pos,this.two.pos)>this.length&&this.springEffect()}),KAPhy.Physics.Compressor||(KAPhy.Physics.Compressor=function(a){KAPhy.Physics.Constraint.call(this,a)},KAPhy.Physics.Compressor.prototype=Object.create(KAPhy.Physics.Constraint.prototype),KAPhy.Physics.Compressor.prototype.update=function(){KAPhy.Physics.Vector2.dist(this.one.pos,this.two.pos)<this.length&&this.springEffect()}),KAPhy.Physics.Cord||(KAPhy.Physics.Cord=function(a){KAPhy.Physics.Constraint.call(this,a)},KAPhy.Physics.Cord.prototype=Object.create(KAPhy.Physics.Constraint.prototype),KAPhy.Physics.Cord.prototype.update=function(){KAPhy.Physics.Vector2.distSq(this.one.pos.canvasMap(),this.two.pos.canvasMap())>this.length*this.length&&(this.springEffect(),this.forceCompensate())}),KAPhy.Physics.Extender||(KAPhy.Physics.Extender=function(a){KAPhy.Physics.Constraint.call(this,a)},KAPhy.Physics.Extender.prototype=Object.create(KAPhy.Physics.Constraint.prototype),KAPhy.Physics.Extender.prototype.update=function(){KAPhy.Physics.Vector2.dist(this.one.pos,this.two.pos)<this.length&&(this.springEffect(),this.forceCompensate())}),KAPhy.Physics.Rod||(KAPhy.Physics.Rod=function(a){KAPhy.Physics.Constraint.call(this,a)},KAPhy.Physics.Rod.prototype=Object.create(KAPhy.Physics.Constraint.prototype),KAPhy.Physics.Rod.prototype.update=function(){this.springEffect(),this.forceCompensate()}),KAPhy.Physics.Spring||(KAPhy.Physics.Spring=function(a){KAPhy.Physics.Constraint.call(this,a)},KAPhy.Physics.Spring.prototype=Object.create(KAPhy.Physics.Constraint.prototype),KAPhy.Physics.Spring.prototype.update=function(){this.springEffect()}),KAPhy.Physics.Vector2.add||(KAPhy.Physics.Vector2.add=function(a,e){return new KAPhy.Physics.Vector2(a.x+e.x,a.y+e.y)}),KAPhy.Physics.Vector2.sub||(KAPhy.Physics.Vector2.sub=function(a,e){return new KAPhy.Physics.Vector2(a.x-e.x,a.y-e.y)}),KAPhy.Physics.Vector2.mult||(KAPhy.Physics.Vector2.mult=function(a,e){return new KAPhy.Physics.Vector2(a.x*e,a.y*e)}),KAPhy.Physics.Vector2.div||(KAPhy.Physics.Vector2.div=function(a,e){return new KAPhy.Physics.Vector2(a.x/e,a.y/e)}),KAPhy.Physics.Vector2.prototype.add||(KAPhy.Physics.Vector2.prototype.add=function(a){this.x+=a.x,this.y+=a.y}),KAPhy.Physics.Vector2.prototype.sub||(KAPhy.Physics.Vector2.prototype.sub=function(a){this.x-=a.x,this.y-=a.y}),KAPhy.Physics.Vector2.prototype.mult||(KAPhy.Physics.Vector2.prototype.mult=function(a){this.x*=a,this.y*=a}),KAPhy.Physics.Vector2.prototype.div||(KAPhy.Physics.Vector2.prototype.div=function(a){this.x/=a,this.y/=a}),KAPhy.Physics.Vector2.canvasMap||(KAPhy.Physics.Vector2.canvasMap=function(a){return new KAPhy.Physics.Vector2(KAPhy.Canvas.toCanvasUnits(a.x),KAPhy.Canvas.toCanvasUnits(a.y))}),KAPhy.Physics.Vector2.prototype.canvasMap||(KAPhy.Physics.Vector2.prototype.canvasMap=function(){return new KAPhy.Physics.Vector2(KAPhy.Canvas.toCanvasUnits(this.x),KAPhy.Canvas.toCanvasUnits(this.y))}),KAPhy.Physics.Vector2.canvasUnmap||(KAPhy.Physics.Vector2.canvasUnmap=function(a){return new KAPhy.Physics.Vector2(KAPhy.Canvas.toPixels(a.x),KAPhy.Canvas.toPixels(a.y))}),KAPhy.Physics.Vector2.prototype.canvasUnmap||(KAPhy.Physics.Vector2.prototype.canvasUnmap=function(){return new KAPhy.Physics.Vector2(KAPhy.Canvas.toPixels(this.x),KAPhy.Canvas.toPixels(this.y))}),KAPhy.Physics.Vector2.array||(KAPhy.Physics.Vector2.array=function(a){return[a.x,a.y]}),KAPhy.Physics.Vector2.prototype.array||(KAPhy.Physics.Vector2.prototype.array=function(){return[this.x,this.y]}),KAPhy.Physics.Vector2.prototype.get||(KAPhy.Physics.Vector2.prototype.get=function(){return new KAPhy.Physics.Vector2(this.x,this.y)}),KAPhy.Physics.Vector2.prototype.set||(KAPhy.Physics.Vector2.prototype.set=function(a,e){this.x=a,this.y=e}),KAPhy.Physics.Vector2.rotate||(KAPhy.Physics.Vector2.rotate=function(a,e){var s=Math.cos(e),n=Math.sin(e);return new KAPhy.Physics.Vector2(a.x*s-a.y*n,a.x*n+a.y*s)}),KAPhy.Physics.Vector2.prototype.rotate||(KAPhy.Physics.Vector2.prototype.rotate=function(a){var e=Math.cos(a),s=Math.sin(a),n=this.x;this.x=n*e-this.y*s,this.y=n*s+this.y*e}),KAPhy.Physics.Vector2.dot||(KAPhy.Physics.Vector2.dot=function(a,e){return a.x*e.x+a.y*e.y}),KAPhy.Physics.Vector2.prototype.dot||(KAPhy.Physics.Vector2.prototype.dot=function(a){return this.x*a.x+this.y*a.y}),KAPhy.Physics.Vector2.mag||(KAPhy.Physics.Vector2.mag=function(a){return Math.sqrt(a.x*a.x+a.y*a.y)}),KAPhy.Physics.Vector2.magSq||(KAPhy.Physics.Vector2.magSq=function(a){return a.x*a.x+a.y*a.y}),KAPhy.Physics.Vector2.normalize||(KAPhy.Physics.Vector2.normalize=function(a){return KAPhy.Physics.Vector2.div(a,a.mag())}),KAPhy.Physics.Vector2.dist||(KAPhy.Physics.Vector2.dist=function(a,e){return KAPhy.Physics.Vector2.sub(a,e).mag()}),KAPhy.Physics.Vector2.distSq||(KAPhy.Physics.Vector2.distSq=function(a,e){return KAPhy.Physics.Vector2.magSq(KAPhy.Physics.Vector2.sub(a,e))}),KAPhy.Physics.Vector2.mid||(KAPhy.Physics.Vector2.mid=function(a,e){return new KAPhy.Physics.Vector2(a.x/2+e.x/2,a.y/2+e.y/2)}),KAPhy.Physics.Vector2.lerp||(KAPhy.Physics.Vector2.lerp=function(a,e,s){return new KAPhy.Physics.Vector2(a.x+(e.x-a.x)*s,a.y+(e.y-a.y)*s)}),KAPhy.Physics.Vector2.prototype.mag||(KAPhy.Physics.Vector2.prototype.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y)}),KAPhy.Physics.Vector2.prototype.magSq||(KAPhy.Physics.Vector2.prototype.magSq=function(){return this.x*this.x+this.y*this.y}),KAPhy.Physics.Vector2.prototype.normalize||(KAPhy.Physics.Vector2.prototype.normalize=function(){this.div(this.mag())}),KAPhy.Physics.Vector2.prototype.dist||(KAPhy.Physics.Vector2.prototype.dist=function(a){return KAPhy.Physics.Vector2.sub(this,a).mag()}),KAPhy.Physics.Vector2.prototype.distSq||(KAPhy.Physics.Vector2.prototype.distSq=function(a){return KAPhy.Physics.Vector2.sub(this,a).magSq()}),KAPhy.Physics.Vector2.prototype.mid||(KAPhy.Physics.Vector2.prototype.mid=function(a){return new KAPhy.Physics.Vector2(this.x/2+a.x/2,this.y/2+a.y/2)}),KAPhy.Physics.Vector2.prototype.lerp||(KAPhy.Physics.Vector2.prototype.lerp=function(a,e){return new KAPhy.Physics.Vector2(this.x+(a.x-this.x)*e,this.y+(a.y-this.y)*e)}),KAPhy.Physics.Vector2.reflect||(KAPhy.Physics.Vector2.reflect=function(a,e,s){return KAPhy.Physics.Vector2.sub(a,KAPhy.Physics.Vector2.mult(KAPhy.Physics.Vector2.sub(a,new KAPhy.Physics.Vector2((KAPhy.Physics.Equation.B(e,s)-KAPhy.Physics.Equation.TB(KAPhy.Physics.Equation.PM(e,s),a))/(KAPhy.Physics.Equation.PM(e,s)-KAPhy.Physics.Equation.M(e,s)),KAPhy.Physics.Equation.M(e,s)*(KAPhy.Physics.Equation.B(e,s)-KAPhy.Physics.Equation.TB(KAPhy.Physics.Equation.PM(e,s),a))/(KAPhy.Physics.Equation.PM(e,s)-KAPhy.Physics.Equation.M(e,s))+KAPhy.Physics.Equation.B(e,s))),2))}),KAPhy.Physics.Vector2.prototype.reflect||(KAPhy.Physics.Vector2.prototype.reflect=function(a,e){return KAPhy.Physics.Vector2.sub(this,KAPhy.Physics.Vector2.mult(KAPhy.Physics.Vector2.sub(this,new KAPhy.Physics.Vector2((KAPhy.Physics.Equation.B(a,e)-KAPhy.Physics.Equation.TB(KAPhy.Physics.Equation.PM(a,e),this))/(KAPhy.Physics.Equation.PM(a,e)-KAPhy.Physics.Equation.M(a,e)),KAPhy.Physics.Equation.M(a,e)*(KAPhy.Physics.Equation.B(a,e)-KAPhy.Physics.Equation.TB(KAPhy.Physics.Equation.PM(a,e),this))/(KAPhy.Physics.Equation.PM(a,e)-KAPhy.Physics.Equation.M(a,e))+KAPhy.Physics.Equation.B(a,e))),2))});